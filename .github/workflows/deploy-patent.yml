---
name: ğŸ“¦ Deploy Patente TRYONYOU

"on":
  push:
    paths:
      - 'public/ZIP_MAESTRO_TRYONYOU*.zip'
    branches:
      - main
  workflow_dispatch:  # Allow manual triggering

jobs:
  deploy:
    name: Desplegar Dossier de Patente
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Verificar existencia del ZIP maestro
        run: |
          echo "ğŸ” Verificando archivos ZIP maestros en /public..."
          ls -lh public/ZIP_MAESTRO_TRYONYOU*.zip || (echo "âŒ Error: No se encontraron archivos ZIP" && exit 1)
      - name: Desplegar dossier de patente
        run: |
          echo "ğŸš€ Ejecutando DEPLOY_EXPRESS.sh..."
          chmod +x ./DEPLOY_EXPRESS.sh
          ./DEPLOY_EXPRESS.sh \
            public/ZIP_MAESTRO_TRYONYOU_ABVET_ULTRA_PLUS_COMPLETO_DEPLOY_EXPRESS.zip

      - name: Verificar despliegue
        run: |
          echo "âœ… Verificando contenido desplegado..."
          if [ -d "./tryonyou_patente_deploy" ]; then
            echo "ğŸ“‹ Archivos desplegados:"
            ls -lh ./tryonyou_patente_deploy/
            echo ""
            echo "ğŸ“Š Total de archivos:"
            find ./tryonyou_patente_deploy -type f | wc -l
          else
            echo "âŒ Error: directorio de despliegue no encontrado"
            exit 1
          fi

      - name: Upload deployment artifacts
        uses: actions/upload-artifact@v4
        with:
          name: tryonyou-patente-desplegada
          path: tryonyou_patente_deploy/
          retention-days: 30

      - name: Resumen de despliegue
        run: |
          echo "ğŸ‰ =================================="
          echo "   DESPLIEGUE COMPLETADO"
          echo "=================================="
          echo ""
          echo "ğŸ“¦ Dossier: TRYONYOU-ABVETOS-ULTRA-PLUS"
          echo "ğŸ“ UbicaciÃ³n: ./tryonyou_patente_deploy/"
          echo "ğŸ”— Artefactos disponibles en GitHub Actions"
          echo ""
          echo "âœ… El dossier de patente ha sido desplegado exitosamente"
